<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Steve Engledow - tmux</title>
        <meta name="author" content="Steve Engledow" />
        <meta name="description" content="All content © 2011-2023 Steve Engledow. All views expressed here are mine and don’t reflect those of Amazon. The contents of this web site are available under the terms of the MIT licence." />
        <link rel="canonical" href="https://engledow.me/2014/06/17/tmux/" />
        <link rel="stylesheet" href="/assets/main.css">
        <link rel="stylesheet" href="/assets/code.css">
    </head>

    <body>
        <header>
            <h1>tmux</h1>
        </header>

        <main>
            <article><p><a href="http://tmux.sourceforge.net/">tmux</a> is the best thing ever. That is all.</p>
<p>No, that is not all. Here is how I make use of tmux to make my life measurably more awesome:</p>
<p>First, my <code>.tmux.conf</code>. This changes tmux's <code>ctrl-b</code> magic key binding to <code>ctrl-a</code> as I've grown far too used to hitting that from when I used <a href="https://www.gnu.org/software/screen/">screen</a>. I set up a few other screen-like bindings too. Finally, I set a few options that make tmux work better with urxvt.</p>
<div class="codehilite"><pre><span></span><code># <span class="nv">Set</span> <span class="nv">the</span> <span class="nv">prefix</span> <span class="nv">to</span> <span class="o">^</span><span class="nv">A</span>.
<span class="nv">unbind</span> <span class="nv">C</span><span class="o">-</span><span class="nv">b</span>
<span class="nv">set</span> <span class="o">-</span><span class="nv">g</span> <span class="nv">prefix</span> <span class="o">^</span><span class="nv">A</span>
<span class="nv">bind</span> <span class="nv">a</span> <span class="k">send</span><span class="o">-</span><span class="nv">prefix</span>

# <span class="nv">Bind</span> <span class="nv">c</span> <span class="nv">to</span> <span class="nv">new</span><span class="o">-</span><span class="nv">window</span>
<span class="nv">unbind</span> <span class="nv">c</span>
<span class="nv">bind</span> <span class="nv">c</span> <span class="nv">new</span><span class="o">-</span><span class="nv">window</span> <span class="o">-</span><span class="nv">c</span> $<span class="nv">PWD</span>

# <span class="nv">Bind</span> <span class="nv">space</span>, <span class="nv">n</span> <span class="nv">to</span> <span class="k">next</span><span class="o">-</span><span class="nv">window</span>
<span class="nv">unbind</span> <span class="s2">&quot;</span><span class="s"> </span><span class="s2">&quot;</span>
<span class="nv">bind</span> <span class="s2">&quot;</span><span class="s"> </span><span class="s2">&quot;</span> <span class="k">next</span><span class="o">-</span><span class="nv">window</span>
<span class="nv">unbind</span> <span class="nv">n</span>
<span class="nv">bind</span> <span class="nv">n</span> <span class="k">next</span><span class="o">-</span><span class="nv">window</span>

# <span class="nv">Bind</span> <span class="nv">p</span> <span class="nv">to</span> <span class="nv">previous</span><span class="o">-</span><span class="nv">window</span>
<span class="nv">unbind</span> <span class="nv">p</span>
<span class="nv">bind</span> <span class="nv">p</span> <span class="nv">previous</span><span class="o">-</span><span class="nv">window</span>

# <span class="nv">A</span> <span class="nv">few</span> <span class="nv">other</span> <span class="nv">settings</span> <span class="nv">to</span> <span class="nv">make</span> <span class="nv">things</span> <span class="nv">funky</span>
<span class="nv">set</span> <span class="o">-</span><span class="nv">g</span> <span class="nv">status</span> <span class="nv">off</span>
<span class="nv">set</span> <span class="o">-</span><span class="nv">g</span> <span class="nv">aggressive</span><span class="o">-</span><span class="nv">resize</span> <span class="nv">on</span>
<span class="nv">set</span> <span class="o">-</span><span class="nv">g</span> <span class="nv">mode</span><span class="o">-</span><span class="nv">keys</span> <span class="nv">vi</span>
<span class="nv">set</span> <span class="o">-</span><span class="nv">g</span> <span class="nv">default</span><span class="o">-</span><span class="nv">terminal</span> <span class="nv">screen</span><span class="o">-</span><span class="mi">256</span><span class="nv">color</span>
<span class="nv">set</span> <span class="o">-</span><span class="nv">g</span> <span class="nv">terminal</span><span class="o">-</span><span class="nv">overrides</span> <span class="s1">&#39;</span><span class="s">rxvt-unicode*:sitm@</span><span class="s1">&#39;</span>
</code></pre></div>

<p>And then here's what I have near the top of my <code>.bashrc</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># If tmux isn&#39;t already running, run it</span>
<span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$TMUX</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">exec</span> ~/bin/tmux
</code></pre></div>

<p>...which goes with this, the contents of <code>~/bin/tmux</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># If there are any sessions that aren&#39;t attached, attach to the first one</span>
<span class="c1"># Otherwise, start a new session</span>

<span class="k">for</span> line <span class="k">in</span> <span class="k">$(</span>tmux ls -F <span class="s2">&quot;#{session_name},#{session_attached}&quot;</span><span class="k">)</span><span class="p">;</span> <span class="k">do</span>
    <span class="nv">name</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$line</span> <span class="p">|</span> cut -d <span class="s1">&#39;,&#39;</span> -f <span class="m">1</span><span class="k">)</span>
    <span class="nv">attached</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$line</span> <span class="p">|</span> cut -d <span class="s1">&#39;,&#39;</span> -f <span class="m">2</span><span class="k">)</span>

    <span class="k">if</span> <span class="o">[</span> <span class="nv">$attached</span> -eq <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        tmux attach -t <span class="nv">$name</span>
        <span class="nb">exit</span>
    <span class="k">fi</span>
<span class="k">done</span>

tmux -u
</code></pre></div>

<p>Basically, what happens is that whenever I start a terminal session, if I'm not already attached to a tmux session, I find a session that's not already attached to and attach to it. If there aren't any, I create a new one.</p>
<p>This really tidies up my workflow and means that I never forget about any old sessions I'd detached.</p>
<p>Oh and one last thing, <code>ctrl-a s</code> is the best thing in tmux ever. It shows a list of tmux sessions which can be expanded to show what's running in them and you can then interactively re-attach your terminal to one of them. In short, I can start a terminal from any desktop or vt and quickly attach to something that's happening on any other. I use this feature <strong>a lot</strong>.</p></article>
        </main>

        <footer>
            <p>
                All content © 2011-2023 Steve Engledow.
                All views expressed here are mine and don't reflect those of Amazon.
                The contents of this web site are available under the terms of the MIT licence.
            </p>
        </footer>
    </body>
</html>
